<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>DrPhysiQ â€“ Staff Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/styles.css" />

    <!-- ðŸš« PREVENT FLICKER -->
    <style>
        body {
            visibility: hidden;
        }
        body.ready {
            visibility: visible;
        }
    </style>
</head>

<body>

<header class="app-header">
    <h2>DrPhysiQ</h2>
    <div>
        Staff: <strong id="staffName">---</strong>
        <button onclick="logout()">Logout</button>
    </div>
</header>

<main class="main">

    <!-- ðŸ” PASSWORD RESET (ONLY SHOWS ON FIRST LOGIN) -->
    <section class="panel password-panel">
        <h3>Change Password</h3>

        <input type="password" id="oldPassword" placeholder="Current password" />
        <input type="password" id="newPassword" placeholder="New password" />

        <button id="changePasswordBtn">Change Password</button>
    </section>

    <!-- ðŸ“Š STAFF REPORT -->
    <section class="panel">
        <h3>My SBU Report</h3>

        <select id="staffReportPeriod">
            <option value="daily">Daily</option>
            <option value="weekly">Weekly</option>
            <option value="monthly" selected>Monthly</option>
        </select>

        <input type="date" id="staffReportDate" />
        <button id="loadMyReportBtn">Load Report</button>

        <div id="myReportResult"></div>
    </section>

    <!-- ðŸ“ˆ DASHBOARD -->
    <section class="panel">
        <h2 id="sbuName">-</h2>

        <p><strong>DAILY TARGET:</strong> â‚¦<span id="dailyBudget">0</span></p>
        <p><strong>SALES TODAY:</strong> â‚¦<span id="salesToday">0</span></p>

        <p>
            <strong>PERFORMANCE:</strong>
            <span id="performance">0</span>%
        </p>

        <p>
            <strong>STATUS:</strong>
            <span id="performanceStatus" class="status-pill">-</span>
        </p>

        <hr />

        <h3>EXPENSES</h3>

        <p>PERSONNEL COST: â‚¦<span id="personnel">0</span></p>
        <p>RENT: â‚¦<span id="rent">0</span></p>
        <p>ELECTRICITY: â‚¦<span id="electricity">0</span></p>

        <p>CONSUMABLES: â‚¦<span id="consumables">0</span></p>
        <p>GENERAL EXPENSES: â‚¦<span id="generalExpenses">0</span></p>
        <p>UTILITIES: â‚¦<span id="utilities">0</span></p>
        <p>MISCELLANEOUS: â‚¦<span id="miscellaneous">0</span></p>

        <p><strong>TOTAL EXPENSES:</strong> â‚¦<span id="totalExpenses">0</span></p>

        <hr />

        <p><strong>NET PROFIT / LOSS:</strong> â‚¦<span id="netProfit">0</span></p>
    </section>

    <!-- ðŸ’° SALES ENTRY -->
    <section class="panel">
        <h3>Enter Todayâ€™s Sales</h3>

        <input type="number" id="salesInput" placeholder="Amount (â‚¦)" min="0" />
        <input type="date" id="salesDate" />
        <input type="text" id="salesNotes" placeholder="Notes (optional)" />

        <button id="saveSalesBtn">Save Sales</button>
    </section>

    <!-- ðŸ’¸ EXPENSE ENTRY -->
    <section class="panel">
        <h3>Enter Todayâ€™s Expense</h3>

        <select id="expenseCategory">
            <option value="consumables">Consumables</option>
            <option value="general_expenses">General Expenses</option>
            <option value="utilities">Utilities</option>
            <option value="miscellaneous">Miscellaneous</option>
        </select>

        <input type="number" id="expenseAmount" placeholder="Amount (â‚¦)" min="0" />
        <input type="date" id="expenseDate" />
        <input type="text" id="expenseNotes" placeholder="Notes (optional)" />

        <button id="saveExpenseBtn">Save Expense</button>
    </section>

    <!-- ðŸ§¾ EXPENSE HISTORY -->
    <section class="panel">
        <h3>Expense History</h3>

        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Consumables</th>
                    <th>General</th>
                    <th>Utilities</th>
                    <th>Misc</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody id="expenseHistoryBody"></tbody>
        </table>
    </section>

    <!-- ðŸ•µï¸ AUDIT LOG -->
    <section class="panel">
        <h3>My Activity</h3>
        <div id="staffAuditLog" class="muted">Loading...</div>
    </section>

</main>

<!-- â— GLOBAL ERROR -->
<div id="globalError" class="error-banner hidden">
    <span id="globalErrorText">Something went wrong</span>
    <button onclick="hideGlobalError()">âœ•</button>
</div>

<script src="js/config.js"></script>
<script src="js/auth.js"></script>
<script src="js/staff.js"></script>

<!-- âœ… REVEAL PAGE ONLY WHEN READY -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        document.body.classList.add("ready");
    });
</script>

</body>
</html>
